{"version":3,"sources":["../src/themes/presets.ts","../src/themes/resolve.ts","../src/i18n/en.ts","../src/i18n/es.ts","../src/i18n/index.ts","../src/components/Icons.tsx","../src/components/ChatButton.tsx","../src/utils/messageHelpers.ts","../src/components/SuggestionBox.tsx","../src/components/MessageBubble.tsx","../src/components/LoadingIndicator.tsx","../src/components/ErrorMessage.tsx","../src/components/MessageInput.tsx","../src/hooks/useScrollToBottom.ts","../src/components/ResizeHandles.tsx","../src/components/ChatWindow.tsx","../src/hooks/useResize.ts","../src/hooks/useMobileDetect.ts","../src/utils/errorClassifier.ts","../src/hooks/useRateLimitRetry.ts","../src/ChatWidget.tsx"],"names":["midnight","ocean","forest","sunset","lavender","presets","defaultTheme","isPresetName","theme","resolveTheme","preset","customConfig","adjustColor","hex","amount","color","num","r","g","b","en","es","translations","isBuiltInLang","lang","getLabels","mergeLabels","customLabels","baseLabels","ChatIcon","size","style","jsx","CloseIcon","jsxs","SendIcon","RestartIcon","ChatButton","position","isOpen","onClick","openLabel","closeLabel","zIndex","openIcon","closeIcon","buttonStyle","e","isTextPart","part","getMessageText","message","SuggestionBox","suggestions","onSelect","title","hoveredIndex","setHoveredIndex","useState","containerStyle","titleStyle","getButtonStyle","isHovered","suggestion","index","Markdown","lazy","err","children","MarkdownErrorBoundary","Component","props","MessageBubble","showSuggestions","isLastAssistantMessage","suggestionsTitle","onSuggestionSelect","remarkGfm","setRemarkGfm","messageText","isUser","useEffect","mod","bubbleStyle","Suspense","LoadingIndicator","text","dotStyle","i","ErrorMessage","errorText","rateLimitErrorText","retryText","autoRetryingText","cancelAutoRetryText","onRetry","errorInfo","countdown","isAutoRetrying","onCancelAutoRetry","displayErrorText","showCountdown","countdownText","MessageInput","value","onChange","onSubmit","placeholder","sendLabel","isLoading","autoFocus","inputRef","useRef","handleSubmit","inputStyle","useScrollToBottom","messageCount","ref","prevMessageCount","scrollToBottom","useCallback","messageAdded","baseHandleStyle","corners","ResizeHandles","onResizeStart","isResizing","Fragment","corner","cursor","ChatWindow","messages","input","onInputChange","onClose","onRestart","error","labels","headerIcon","width","height","isClosing","resizable","isMobile","messagesEndRef","lastAssistantMessageIndex","found","msg","idx","windowStyle","headerStyle","animationClass","STORAGE_KEY","clamp","min","max","loadSavedSize","stored","parsed","saveSize","useResize","initialWidth","initialHeight","minWidth","maxWidth","minHeight","maxHeight","enabled","setWidth","saved","setHeight","setIsResizing","resizeState","handleResizeStart","handleMouseMove","startX","startY","startWidth","startHeight","deltaX","deltaY","newWidth","newHeight","handleMouseUp","MOBILE_BREAKPOINT","useMobileDetect","setIsMobile","mediaQuery","handleChange","RATE_LIMIT_PATTERNS","extractStatusCode","response","statusMatch","extractRetryAfter","headers","retryAfterHeader","seconds","secondsMatch","matchesRateLimitPattern","pattern","determineErrorType","statusCode","isRetriable","type","classifyError","retryAfterSeconds","isRateLimitError","DEFAULT_OPTIONS","calculateBackoffDelay","attempt","baseDelayMs","maxDelayMs","serverRetryAfterSeconds","exponentialDelay","jitter","useRateLimitRetry","autoRetry","maxRetries","setCountdown","setIsAutoRetrying","retryAttempt","setRetryAttempt","prevErrorRef","countdownIntervalRef","retryTimeoutRef","clearTimers","cancelAutoRetry","manualRetry","startCountdown","delayMs","prev","currentError","newAttempt","ChatErrorBoundary","DEFAULT_FONT_FAMILY","INTER_FONT_URL","ANIMATION_DURATION","ChatWidgetInternal","apiUrl","greeting","defaultOpen","icon","fontFamily","loadDefaultFont","rateLimitOptions","setIsOpen","isVisible","setIsVisible","setIsClosing","setInput","sessionId","setSessionId","fontLoaded","setFontLoaded","currentWidth","currentHeight","timer","link","transport","useMemo","DefaultChatTransport","initialMessages","sendMessage","regenerate","setMessages","status","useChat","handleRestart","handleKeyDown","toggleChat","handleRetry","handleSuggestionSelect","parseCssSize","fallback","ChatWidget","themeProp","customTitle","customPlaceholder","customFontFamily","widthPx","heightPx","minWidthPx","maxWidthPx","minHeightPx","maxHeightPx","ChatWidget_default"],"mappings":"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","file":"index.js","sourcesContent":["import type { ThemePreset } from './types';\n\n/**\n * Midnight - Dark indigo theme (Default)\n * A sophisticated dark theme with indigo accents\n */\nexport const midnight: ThemePreset = {\n  name: 'midnight',\n  primary: '#6366f1',\n  primaryHover: '#4f46e5',\n  background: '#0f172a',\n  surface: '#1e293b',\n  surfaceHover: '#334155',\n  text: '#f1f5f9',\n  textSecondary: '#94a3b8',\n  border: '#334155',\n  userBubble: '#6366f1',\n  userBubbleText: '#ffffff',\n  assistantBubble: '#1e293b',\n  assistantBubbleText: '#f1f5f9',\n  error: '#ef4444',\n  errorBg: '#450a0a',\n};\n\n/**\n * Ocean - Dark blue theme\n * A calming dark theme with sky blue accents\n */\nexport const ocean: ThemePreset = {\n  name: 'ocean',\n  primary: '#0ea5e9',\n  primaryHover: '#0284c7',\n  background: '#0c1222',\n  surface: '#172033',\n  surfaceHover: '#1e3a5f',\n  text: '#e0f2fe',\n  textSecondary: '#7dd3fc',\n  border: '#1e3a5f',\n  userBubble: '#0ea5e9',\n  userBubbleText: '#ffffff',\n  assistantBubble: '#172033',\n  assistantBubbleText: '#e0f2fe',\n  error: '#f87171',\n  errorBg: '#450a0a',\n};\n\n/**\n * Forest - Dark green theme\n * A nature-inspired dark theme with green accents\n */\nexport const forest: ThemePreset = {\n  name: 'forest',\n  primary: '#22c55e',\n  primaryHover: '#16a34a',\n  background: '#052e16',\n  surface: '#14532d',\n  surfaceHover: '#166534',\n  text: '#dcfce7',\n  textSecondary: '#86efac',\n  border: '#166534',\n  userBubble: '#22c55e',\n  userBubbleText: '#052e16',\n  assistantBubble: '#14532d',\n  assistantBubbleText: '#dcfce7',\n  error: '#f87171',\n  errorBg: '#450a0a',\n};\n\n/**\n * Sunset - Dark warm theme\n * A warm dark theme with orange accents\n */\nexport const sunset: ThemePreset = {\n  name: 'sunset',\n  primary: '#f97316',\n  primaryHover: '#ea580c',\n  background: '#1c1917',\n  surface: '#292524',\n  surfaceHover: '#44403c',\n  text: '#fafaf9',\n  textSecondary: '#d6d3d1',\n  border: '#44403c',\n  userBubble: '#f97316',\n  userBubbleText: '#ffffff',\n  assistantBubble: '#292524',\n  assistantBubbleText: '#fafaf9',\n  error: '#f87171',\n  errorBg: '#450a0a',\n};\n\n/**\n * Lavender - Dark purple theme\n * An elegant dark theme with purple accents\n */\nexport const lavender: ThemePreset = {\n  name: 'lavender',\n  primary: '#a855f7',\n  primaryHover: '#9333ea',\n  background: '#1a0a2e',\n  surface: '#2d1b4e',\n  surfaceHover: '#3b2d5c',\n  text: '#f3e8ff',\n  textSecondary: '#d8b4fe',\n  border: '#3b2d5c',\n  userBubble: '#a855f7',\n  userBubbleText: '#ffffff',\n  assistantBubble: '#2d1b4e',\n  assistantBubbleText: '#f3e8ff',\n  error: '#f87171',\n  errorBg: '#450a0a',\n};\n\n/**\n * All available theme presets\n */\nexport const presets = {\n  midnight,\n  ocean,\n  forest,\n  sunset,\n  lavender,\n} as const;\n\n/**\n * Default theme (midnight)\n */\nexport const defaultTheme = midnight;\n","import type { ThemeProp, ResolvedTheme, ThemeConfig, PresetThemeName } from './types';\nimport { presets, defaultTheme } from './presets';\n\n/**\n * Check if a value is a preset theme name\n */\nfunction isPresetName(theme: ThemeProp): theme is PresetThemeName {\n  return typeof theme === 'string' && theme in presets;\n}\n\n/**\n * Resolve a theme prop to a complete theme configuration\n *\n * @param theme - Preset name or custom theme config\n * @returns Fully resolved theme with all properties\n *\n * @example\n * ```ts\n * // From preset name\n * const theme = resolveTheme('ocean');\n *\n * // From partial config (inherits defaults from midnight)\n * const theme = resolveTheme({\n *   primary: '#ff0000',\n *   background: '#000000',\n *   surface: '#111111',\n *   text: '#ffffff',\n * });\n * ```\n */\nexport function resolveTheme(theme?: ThemeProp): ResolvedTheme {\n  // No theme provided - use default\n  if (!theme) {\n    return {\n      ...defaultTheme,\n      name: defaultTheme.name,\n    } as ResolvedTheme;\n  }\n\n  // Preset name provided\n  if (isPresetName(theme)) {\n    const preset = presets[theme];\n    return {\n      ...preset,\n      name: preset.name,\n    } as ResolvedTheme;\n  }\n\n  // Custom config provided - merge with defaults\n  const customConfig = theme as ThemeConfig;\n  return {\n    name: 'custom',\n    primary: customConfig.primary,\n    primaryHover: customConfig.primaryHover ?? adjustColor(customConfig.primary, -15),\n    background: customConfig.background,\n    surface: customConfig.surface,\n    surfaceHover: customConfig.surfaceHover ?? adjustColor(customConfig.surface, 10),\n    text: customConfig.text,\n    textSecondary: customConfig.textSecondary ?? adjustColor(customConfig.text, -30),\n    border: customConfig.border ?? customConfig.surface,\n    userBubble: customConfig.userBubble ?? customConfig.primary,\n    userBubbleText: customConfig.userBubbleText ?? '#ffffff',\n    assistantBubble: customConfig.assistantBubble ?? customConfig.surface,\n    assistantBubbleText: customConfig.assistantBubbleText ?? customConfig.text,\n    error: customConfig.error ?? '#ef4444',\n    errorBg: customConfig.errorBg ?? '#450a0a',\n  };\n}\n\n/**\n * Adjust a hex color's lightness\n * Positive amount = lighter, negative = darker\n */\nfunction adjustColor(hex: string, amount: number): string {\n  // Remove # if present\n  const color = hex.replace(/^#/, '');\n\n  // Parse RGB\n  const num = parseInt(color, 16);\n  let r = (num >> 16) + amount;\n  let g = ((num >> 8) & 0x00ff) + amount;\n  let b = (num & 0x0000ff) + amount;\n\n  // Clamp values\n  r = Math.max(0, Math.min(255, r));\n  g = Math.max(0, Math.min(255, g));\n  b = Math.max(0, Math.min(255, b));\n\n  // Return hex\n  return `#${((r << 16) | (g << 8) | b).toString(16).padStart(6, '0')}`;\n}\n","import type { Labels } from './types';\n\n/**\n * English translations (default)\n */\nexport const en: Labels = {\n  title: 'Chat Assistant',\n  placeholder: 'Type your message...',\n  send: 'Send message',\n  close: 'Close chat',\n  open: 'Open chat',\n  thinking: 'Thinking',\n  error: 'Something went wrong. Please try again.',\n  retry: 'Retry',\n  suggestionsTitle: 'Suggested questions',\n  restart: 'Restart chat',\n  rateLimitError: 'Too many requests. Please wait a moment before trying again.',\n  rateLimitRetryIn: 'You can retry in',\n  autoRetrying: 'Retrying in',\n  cancelAutoRetry: 'Cancel',\n};\n","import type { Labels } from './types';\n\n/**\n * Spanish translations\n */\nexport const es: Labels = {\n  title: 'Asistente de Chat',\n  placeholder: 'Escribe tu mensaje...',\n  send: 'Enviar mensaje',\n  close: 'Cerrar chat',\n  open: 'Abrir chat',\n  thinking: 'Pensando',\n  error: 'Algo sali mal. Por favor, intenta de nuevo.',\n  retry: 'Reintentar',\n  suggestionsTitle: 'Preguntas sugeridas',\n  restart: 'Reiniciar chat',\n  rateLimitError: 'Demasiadas solicitudes. Por favor espera un momento.',\n  rateLimitRetryIn: 'Puedes reintentar en',\n  autoRetrying: 'Reintentando en',\n  cancelAutoRetry: 'Cancelar',\n};\n","import type { Lang, Labels, Translations, BuiltInLang } from './types';\nimport { en } from './en';\nimport { es } from './es';\n\nexport * from './types';\n\n/**\n * Built-in translations (English and Spanish)\n * For other languages, use the `labels` prop to provide custom translations\n */\nexport const translations: Translations = {\n  en,\n  es,\n};\n\n/**\n * Check if a language has built-in translations\n */\nfunction isBuiltInLang(lang: string): lang is BuiltInLang {\n  return lang in translations;\n}\n\n/**\n * Get labels for a specific language\n *\n * @param lang - Language code (any string, e.g., 'en', 'es', 'fr', 'de', 'pt-BR')\n * @returns Labels for the specified language, or English defaults if not found\n *\n * @example\n * ```ts\n * getLabels('en');  // Returns English labels\n * getLabels('es');  // Returns Spanish labels\n * getLabels('fr');  // Returns English labels (no built-in French)\n * ```\n */\nexport function getLabels(lang: Lang): Labels {\n  if (isBuiltInLang(lang)) {\n    return translations[lang];\n  }\n  // Fallback to English for unknown languages\n  return translations.en;\n}\n\n/**\n * Merge custom labels with defaults\n *\n * @param lang - Base language code (any string)\n * @param customLabels - Partial custom labels to override\n * @returns Complete labels with overrides applied\n *\n * @example\n * ```ts\n * // French with custom labels\n * mergeLabels('fr', {\n *   title: 'Assistant',\n *   placeholder: 'crivez votre message...',\n *   send: 'Envoyer',\n *   close: 'Fermer',\n *   open: 'Ouvrir le chat',\n *   thinking: 'Rflexion',\n *   error: 'Une erreur est survenue',\n *   retry: 'Ressayer',\n * });\n * ```\n */\nexport function mergeLabels(lang: Lang, customLabels?: Partial<Labels>): Labels {\n  const baseLabels = getLabels(lang);\n  if (!customLabels) return baseLabels;\n  return { ...baseLabels, ...customLabels };\n}\n","import type { CSSProperties } from 'react';\n\ninterface IconProps {\n  size?: number;\n  style?: CSSProperties;\n}\n\nexport function ChatIcon({ size = 24, style }: IconProps) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={size}\n      height={size}\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      style={style}\n    >\n      <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" />\n    </svg>\n  );\n}\n\nexport function CloseIcon({ size = 24, style }: IconProps) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={size}\n      height={size}\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      style={style}\n    >\n      <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n      <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n    </svg>\n  );\n}\n\nexport function SendIcon({ size = 18, style }: IconProps) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={size}\n      height={size}\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      style={style}\n    >\n      <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\" />\n      <polygon points=\"22 2 15 22 11 13 2 9 22 2\" />\n    </svg>\n  );\n}\n\nexport function RestartIcon({ size = 18, style }: IconProps) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={size}\n      height={size}\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      style={style}\n    >\n      <path d=\"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\" />\n      <path d=\"M3 3v5h5\" />\n    </svg>\n  );\n}\n","'use client';\n\nimport type { CSSProperties, ReactNode } from 'react';\nimport type { ResolvedTheme } from '../themes/types';\nimport type { Position } from '../types';\nimport { ChatIcon, CloseIcon } from './Icons';\n\ninterface ChatButtonProps {\n  theme: ResolvedTheme;\n  position: Position;\n  isOpen: boolean;\n  onClick: () => void;\n  openLabel: string;\n  closeLabel: string;\n  zIndex: number;\n  /** Custom icon for open state */\n  openIcon?: ReactNode;\n  /** Custom icon for close state */\n  closeIcon?: ReactNode;\n}\n\nexport function ChatButton({\n  theme,\n  position,\n  isOpen,\n  onClick,\n  openLabel,\n  closeLabel,\n  zIndex,\n  openIcon,\n  closeIcon,\n}: ChatButtonProps) {\n  const positionStyles: CSSProperties =\n    position === 'bottom-left'\n      ? { left: '1rem', right: 'auto' }\n      : { right: '1rem', left: 'auto' };\n\n  const buttonStyle: CSSProperties = {\n    position: 'fixed',\n    bottom: '1rem',\n    ...positionStyles,\n    zIndex,\n    display: 'flex',\n    height: '3.5rem',\n    width: '3.5rem',\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderRadius: '50%',\n    backgroundColor: theme.primary,\n    color: '#ffffff',\n    border: 'none',\n    cursor: 'pointer',\n    boxShadow: `0 4px 20px ${theme.primary}66`,\n    transition: 'all 0.2s',\n  };\n\n  return (\n    <button\n      onClick={onClick}\n      aria-label={isOpen ? closeLabel : openLabel}\n      aria-expanded={isOpen}\n      style={buttonStyle}\n      onMouseEnter={(e) => {\n        e.currentTarget.style.transform = 'scale(1.05)';\n        e.currentTarget.style.backgroundColor = theme.primaryHover;\n        e.currentTarget.style.boxShadow = `0 6px 24px ${theme.primary}80`;\n      }}\n      onMouseLeave={(e) => {\n        e.currentTarget.style.transform = 'scale(1)';\n        e.currentTarget.style.backgroundColor = theme.primary;\n        e.currentTarget.style.boxShadow = `0 4px 20px ${theme.primary}66`;\n      }}\n    >\n      {isOpen ? (closeIcon ?? <CloseIcon />) : (openIcon ?? <ChatIcon />)}\n    </button>\n  );\n}\n","import type { UIMessage } from 'ai';\n\n/**\n * Text part from UIMessage\n */\ninterface TextPart {\n  type: 'text';\n  text: string;\n}\n\n/**\n * Type guard for text parts\n */\nfunction isTextPart(part: unknown): part is TextPart {\n  return (\n    typeof part === 'object' &&\n    part !== null &&\n    'type' in part &&\n    (part as TextPart).type === 'text' &&\n    'text' in part &&\n    typeof (part as TextPart).text === 'string'\n  );\n}\n\n/**\n * Extract text content from a UIMessage's parts array\n *\n * @param message - UIMessage from Vercel AI SDK v6\n * @returns Combined text content from all text parts\n */\nexport function getMessageText(message: UIMessage): string {\n  if (!message.parts || message.parts.length === 0) {\n    return '';\n  }\n\n  return message.parts.filter(isTextPart).map((part) => part.text).join('');\n}\n","'use client';\n\nimport { useState, type CSSProperties } from 'react';\nimport type { ResolvedTheme } from '../themes/types';\n\ninterface SuggestionBoxProps {\n  suggestions: string[];\n  onSelect: (suggestion: string) => void;\n  theme: ResolvedTheme;\n  title: string;\n}\n\nexport function SuggestionBox({ suggestions, onSelect, theme, title }: SuggestionBoxProps) {\n  const [hoveredIndex, setHoveredIndex] = useState<number | null>(null);\n\n  if (!suggestions?.length) return null;\n\n  const containerStyle: CSSProperties = {\n    marginTop: '0.75rem',\n    display: 'flex',\n    flexDirection: 'column',\n    gap: '0.5rem',\n  };\n\n  const titleStyle: CSSProperties = {\n    fontSize: '0.75rem',\n    color: theme.textSecondary,\n    marginBottom: '0.25rem',\n  };\n\n  const getButtonStyle = (isHovered: boolean): CSSProperties => ({\n    padding: '0.5rem 0.75rem',\n    fontSize: '0.875rem',\n    backgroundColor: isHovered ? theme.primary : theme.surface,\n    color: isHovered ? '#ffffff' : theme.text,\n    border: `1px solid ${isHovered ? theme.primary : theme.border}`,\n    borderRadius: '0.5rem',\n    cursor: 'pointer',\n    textAlign: 'left',\n    transition: 'all 0.2s',\n    fontFamily: 'inherit',\n  });\n\n  return (\n    <div style={containerStyle}>\n      <span style={titleStyle}>{title}</span>\n      {suggestions.slice(0, 3).map((suggestion, index) => (\n        <button\n          key={index}\n          type=\"button\"\n          style={getButtonStyle(hoveredIndex === index)}\n          onClick={() => onSelect(suggestion)}\n          onMouseEnter={() => setHoveredIndex(index)}\n          onMouseLeave={() => setHoveredIndex(null)}\n        >\n          {suggestion}\n        </button>\n      ))}\n    </div>\n  );\n}\n","'use client';\n\nimport { lazy, Suspense, useState, useEffect, Component, type ReactNode, type CSSProperties } from 'react';\nimport type { UIMessage } from 'ai';\nimport type { ResolvedTheme } from '../themes/types';\nimport { getMessageText } from '../utils/messageHelpers';\nimport { SuggestionBox } from './SuggestionBox';\n\n// Lazy load react-markdown\nconst Markdown = lazy(() =>\n  import('react-markdown').catch((err) => {\n    console.error('[ai-chat-widget] Failed to load react-markdown:', err);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return { default: ({ children }: any) => <span>{children}</span> } as any;\n  })\n);\n\n// Error boundary for markdown rendering\nclass MarkdownErrorBoundary extends Component<\n  { children: ReactNode; fallback: string },\n  { hasError: boolean }\n> {\n  constructor(props: { children: ReactNode; fallback: string }) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError() {\n    return { hasError: true };\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return <span>{this.props.fallback}</span>;\n    }\n    return this.props.children;\n  }\n}\n\n/**\n * Suggestions data part type (AI SDK v6 format).\n * Backend sends this as: { type: 'data-suggestions', data: string[] }\n */\ninterface SuggestionsDataPart {\n  type: 'data-suggestions';\n  data: string[];\n}\n\ninterface MessageBubbleProps {\n  message: UIMessage;\n  theme: ResolvedTheme;\n  showSuggestions?: boolean;\n  isLastAssistantMessage?: boolean;\n  suggestionsTitle?: string;\n  onSuggestionSelect?: (suggestion: string) => void;\n}\n\nexport function MessageBubble({\n  message,\n  theme,\n  showSuggestions = true,\n  isLastAssistantMessage = false,\n  suggestionsTitle = 'Suggested questions',\n  onSuggestionSelect,\n}: MessageBubbleProps) {\n  const [remarkGfm, setRemarkGfm] = useState<typeof import('remark-gfm').default | null>(null);\n  const messageText = getMessageText(message);\n  const isUser = message.role === 'user';\n\n  // Lazy load remark-gfm for assistant messages\n  useEffect(() => {\n    if (!isUser && !remarkGfm) {\n      import('remark-gfm')\n        .then((mod) => {\n          setRemarkGfm(() => mod.default);\n        })\n        .catch((err) => {\n          console.error('[ai-chat-widget] Failed to load remark-gfm:', err);\n        });\n    }\n  }, [isUser, remarkGfm]);\n\n  if (!messageText) return null;\n\n  // Extract suggestions from message parts (data-suggestions type)\n  // AI SDK v6 uses { type: 'data-suggestions', data: string[] } format\n  const suggestions = !isUser && showSuggestions && isLastAssistantMessage && onSuggestionSelect\n    ? (message.parts?.find(\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (part: any): part is SuggestionsDataPart => part.type === 'data-suggestions'\n      )?.data ?? [])\n    : [];\n\n  const bubbleStyle: CSSProperties = {\n    maxWidth: '85%',\n    borderRadius: '1rem',\n    padding: '0.5rem 1rem',\n    backgroundColor: isUser ? theme.userBubble : theme.assistantBubble,\n    color: isUser ? theme.userBubbleText : theme.assistantBubbleText,\n  };\n\n  const markdownStyle: CSSProperties = {\n    fontSize: '0.875rem',\n    lineHeight: 1.5,\n  };\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: isUser ? 'flex-end' : 'flex-start',\n      }}\n    >\n      <div style={bubbleStyle}>\n        {isUser ? (\n          <p style={{ fontSize: '0.875rem', margin: 0 }}>{messageText}</p>\n        ) : (\n          <div style={markdownStyle} className=\"ai-chat-markdown\">\n            <MarkdownErrorBoundary fallback={messageText}>\n              <Suspense fallback={<span>{messageText}</span>}>\n                <Markdown remarkPlugins={remarkGfm ? [remarkGfm] : []}>\n                  {messageText}\n                </Markdown>\n              </Suspense>\n            </MarkdownErrorBoundary>\n          </div>\n        )}\n      </div>\n      {suggestions.length > 0 && onSuggestionSelect && (\n        <SuggestionBox\n          suggestions={suggestions}\n          onSelect={onSuggestionSelect}\n          theme={theme}\n          title={suggestionsTitle}\n        />\n      )}\n    </div>\n  );\n}\n","import type { CSSProperties } from 'react';\nimport type { ResolvedTheme } from '../themes/types';\n\ninterface LoadingIndicatorProps {\n  theme: ResolvedTheme;\n  text: string;\n}\n\nexport function LoadingIndicator({ theme, text }: LoadingIndicatorProps) {\n  const dotStyle: CSSProperties = {\n    height: '0.5rem',\n    width: '0.5rem',\n    borderRadius: '50%',\n    backgroundColor: theme.primary,\n  };\n\n  return (\n    <div style={{ display: 'flex', justifyContent: 'flex-start' }}>\n      <div\n        style={{\n          borderRadius: '1rem',\n          backgroundColor: theme.assistantBubble,\n          padding: '0.5rem 1rem',\n          color: theme.assistantBubbleText,\n        }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          <div style={{ display: 'flex', gap: '0.25rem' }}>\n            {[0, 1, 2].map((i) => (\n              <span\n                key={i}\n                style={{\n                  ...dotStyle,\n                  animation: 'ai-chat-bounce 1s infinite',\n                  animationDelay: `${-0.3 + i * 0.15}s`,\n                }}\n              />\n            ))}\n          </div>\n          <span\n            style={{\n              fontSize: '0.875rem',\n              color: theme.textSecondary,\n            }}\n          >\n            {text}...\n          </span>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import type { ResolvedTheme } from '../themes/types';\nimport type { ErrorInfo } from '../utils/errorTypes';\n\ninterface ErrorMessageProps {\n  theme: ResolvedTheme;\n  errorText: string;\n  rateLimitErrorText: string;\n  retryText: string;\n  autoRetryingText: string;\n  cancelAutoRetryText: string;\n  onRetry: () => void;\n  errorInfo?: ErrorInfo | null;\n  countdown?: number;\n  isAutoRetrying?: boolean;\n  onCancelAutoRetry?: () => void;\n}\n\nexport function ErrorMessage({\n  theme,\n  errorText,\n  rateLimitErrorText,\n  retryText,\n  autoRetryingText,\n  cancelAutoRetryText,\n  onRetry,\n  errorInfo,\n  countdown = 0,\n  isAutoRetrying = false,\n  onCancelAutoRetry,\n}: ErrorMessageProps) {\n  // Use rate limit error text if this is a rate limit error\n  const displayErrorText = errorInfo?.type === 'rate_limit' ? rateLimitErrorText : errorText;\n\n  // Show countdown if available\n  const showCountdown = countdown > 0;\n  const countdownText = isAutoRetrying\n    ? `${autoRetryingText} ${countdown}s...`\n    : `${countdown}s`;\n\n  return (\n    <div style={{ display: 'flex', justifyContent: 'flex-start' }}>\n      <div\n        style={{\n          borderRadius: '1rem',\n          backgroundColor: theme.errorBg,\n          padding: '0.5rem 1rem',\n          color: theme.error,\n        }}\n      >\n        <p style={{ fontSize: '0.875rem', margin: 0 }}>{displayErrorText}</p>\n\n        {showCountdown && (\n          <p\n            style={{\n              fontSize: '0.75rem',\n              margin: '0.25rem 0 0 0',\n              opacity: 0.9,\n            }}\n          >\n            {countdownText}\n          </p>\n        )}\n\n        <div style={{ display: 'flex', gap: '0.75rem', marginTop: '0.25rem' }}>\n          {/* Retry button - always show unless auto-retrying with countdown */}\n          {!(isAutoRetrying && showCountdown) && (\n            <button\n              onClick={onRetry}\n              style={{\n                fontSize: '0.875rem',\n                fontWeight: 500,\n                color: theme.error,\n                textDecoration: 'underline',\n                background: 'none',\n                border: 'none',\n                cursor: 'pointer',\n                padding: 0,\n              }}\n            >\n              {retryText}\n            </button>\n          )}\n\n          {/* Cancel button - show when auto-retrying */}\n          {isAutoRetrying && showCountdown && onCancelAutoRetry && (\n            <button\n              onClick={onCancelAutoRetry}\n              style={{\n                fontSize: '0.875rem',\n                fontWeight: 500,\n                color: theme.error,\n                textDecoration: 'underline',\n                background: 'none',\n                border: 'none',\n                cursor: 'pointer',\n                padding: 0,\n                opacity: 0.8,\n              }}\n            >\n              {cancelAutoRetryText}\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","'use client';\n\nimport { useRef, useEffect, type CSSProperties } from 'react';\nimport type { ResolvedTheme } from '../themes/types';\nimport { SendIcon } from './Icons';\n\ninterface MessageInputProps {\n  theme: ResolvedTheme;\n  value: string;\n  onChange: (value: string) => void;\n  onSubmit: () => void;\n  placeholder: string;\n  sendLabel: string;\n  isLoading: boolean;\n  autoFocus?: boolean;\n}\n\nexport function MessageInput({\n  theme,\n  value,\n  onChange,\n  onSubmit,\n  placeholder,\n  sendLabel,\n  isLoading,\n  autoFocus,\n}: MessageInputProps) {\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    if (autoFocus) {\n      inputRef.current?.focus();\n    }\n  }, [autoFocus]);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!value.trim() || isLoading) return;\n    onSubmit();\n  };\n\n  const inputStyle: CSSProperties = {\n    flex: 1,\n    borderRadius: '9999px',\n    border: `1px solid ${theme.border}`,\n    backgroundColor: theme.surface,\n    padding: '0.5rem 1rem',\n    fontSize: '0.875rem',\n    color: theme.text,\n    outline: 'none',\n    transition: 'all 0.2s',\n    opacity: isLoading ? 0.5 : 1,\n  };\n\n  const buttonStyle: CSSProperties = {\n    display: 'flex',\n    height: '2.5rem',\n    width: '2.5rem',\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderRadius: '50%',\n    backgroundColor: theme.primary,\n    color: '#ffffff',\n    border: 'none',\n    cursor: isLoading || !value.trim() ? 'not-allowed' : 'pointer',\n    opacity: isLoading || !value.trim() ? 0.5 : 1,\n    transition: 'all 0.2s',\n  };\n\n  return (\n    <form\n      onSubmit={handleSubmit}\n      style={{\n        borderTop: `1px solid ${theme.border}`,\n        backgroundColor: theme.surface,\n        padding: '1rem',\n      }}\n    >\n      <div style={{ display: 'flex', gap: '0.5rem' }}>\n        <input\n          ref={inputRef}\n          type=\"text\"\n          value={value}\n          onChange={(e) => onChange(e.target.value)}\n          placeholder={placeholder}\n          disabled={isLoading}\n          style={inputStyle}\n          onFocus={(e) => {\n            e.currentTarget.style.borderColor = theme.primary;\n            e.currentTarget.style.boxShadow = `0 0 0 2px ${theme.primary}33`;\n          }}\n          onBlur={(e) => {\n            e.currentTarget.style.borderColor = theme.border;\n            e.currentTarget.style.boxShadow = 'none';\n          }}\n        />\n        <button\n          type=\"submit\"\n          disabled={isLoading || !value.trim()}\n          aria-label={sendLabel}\n          style={buttonStyle}\n          onMouseEnter={(e) => {\n            if (!isLoading && value.trim()) {\n              e.currentTarget.style.backgroundColor = theme.primaryHover;\n            }\n          }}\n          onMouseLeave={(e) => {\n            e.currentTarget.style.backgroundColor = theme.primary;\n          }}\n        >\n          <SendIcon />\n        </button>\n      </div>\n    </form>\n  );\n}\n","import { useCallback, useRef, useEffect } from 'react';\n\n/**\n * Hook for auto-scrolling to bottom of a container\n *\n * Only scrolls when:\n * - A new message is added (messageCount changes)\n * - During streaming (isLoading is true)\n *\n * Does NOT scroll when suggestions load after streaming ends,\n * which prevents interrupting the user while they're reading.\n *\n * @param messageCount - Number of messages (triggers scroll when changes)\n * @param isLoading - Whether the assistant is currently streaming\n * @returns Ref to attach to the scroll target element\n */\nexport function useScrollToBottom(messageCount: number, isLoading: boolean) {\n  const ref = useRef<HTMLDivElement>(null);\n  const prevMessageCount = useRef(messageCount);\n\n  const scrollToBottom = useCallback(() => {\n    ref.current?.scrollIntoView({ behavior: 'smooth' });\n  }, []);\n\n  useEffect(() => {\n    const messageAdded = messageCount > prevMessageCount.current;\n    prevMessageCount.current = messageCount;\n\n    // Scroll when a new message is added or during streaming\n    if (messageAdded || isLoading) {\n      scrollToBottom();\n    }\n  }, [messageCount, isLoading, scrollToBottom]);\n\n  return { ref, scrollToBottom };\n}\n","'use client';\n\nimport type { CSSProperties } from 'react';\nimport type { ResizeCorner } from '../hooks/useResize';\n\ninterface ResizeHandlesProps {\n  onResizeStart: (corner: ResizeCorner, e: React.MouseEvent) => void;\n  isResizing: boolean;\n}\n\nconst HANDLE_SIZE = 16;\n\nconst baseHandleStyle: CSSProperties = {\n  position: 'absolute',\n  width: HANDLE_SIZE,\n  height: HANDLE_SIZE,\n  zIndex: 10,\n  // Invisible but interactive\n  background: 'transparent',\n};\n\nconst corners: { corner: ResizeCorner; style: CSSProperties; cursor: string }[] = [\n  {\n    corner: 'nw',\n    style: { top: 0, left: 0 },\n    cursor: 'nwse-resize',\n  },\n  {\n    corner: 'ne',\n    style: { top: 0, right: 0 },\n    cursor: 'nesw-resize',\n  },\n  {\n    corner: 'sw',\n    style: { bottom: 0, left: 0 },\n    cursor: 'nesw-resize',\n  },\n  {\n    corner: 'se',\n    style: { bottom: 0, right: 0 },\n    cursor: 'nwse-resize',\n  },\n];\n\nexport function ResizeHandles({ onResizeStart, isResizing }: ResizeHandlesProps) {\n  return (\n    <>\n      {corners.map(({ corner, style, cursor }) => (\n        <div\n          key={corner}\n          aria-hidden=\"true\"\n          style={{\n            ...baseHandleStyle,\n            ...style,\n            cursor: isResizing ? cursor : cursor,\n          }}\n          onMouseDown={(e) => onResizeStart(corner, e)}\n        />\n      ))}\n    </>\n  );\n}\n","'use client';\n\nimport type { CSSProperties, ReactNode } from 'react';\nimport type { UIMessage } from 'ai';\nimport type { ResolvedTheme } from '../themes/types';\nimport type { Position, Labels } from '../types';\nimport type { ErrorInfo } from '../utils/errorTypes';\nimport { CloseIcon, RestartIcon } from './Icons';\nimport { MessageBubble } from './MessageBubble';\nimport { LoadingIndicator } from './LoadingIndicator';\nimport { ErrorMessage } from './ErrorMessage';\nimport { MessageInput } from './MessageInput';\nimport { useScrollToBottom } from '../hooks/useScrollToBottom';\nimport { ResizeHandles } from './ResizeHandles';\n\ninterface ChatWindowProps {\n  theme: ResolvedTheme;\n  position: Position;\n  messages: UIMessage[];\n  input: string;\n  onInputChange: (value: string) => void;\n  onSubmit: () => void;\n  onRetry: () => void;\n  onClose: () => void;\n  onRestart: () => void;\n  onSuggestionSelect?: (suggestion: string) => void;\n  isLoading: boolean;\n  error: Error | undefined;\n  labels: Labels;\n  title?: string;\n  headerIcon?: ReactNode;\n  placeholder: string;\n  width: number;\n  height: number;\n  zIndex: number;\n  showSuggestions: boolean;\n  isClosing?: boolean;\n  // New resize props\n  resizable: boolean;\n  isMobile: boolean;\n  isResizing: boolean;\n  onResizeStart: (corner: 'nw' | 'ne' | 'sw' | 'se', e: React.MouseEvent) => void;\n  // Rate limit error handling props\n  errorInfo?: ErrorInfo | null;\n  countdown?: number;\n  isAutoRetrying?: boolean;\n  onCancelAutoRetry?: () => void;\n}\n\nexport function ChatWindow({\n  theme,\n  position,\n  messages,\n  input,\n  onInputChange,\n  onSubmit,\n  onRetry,\n  onClose,\n  onRestart,\n  onSuggestionSelect,\n  isLoading,\n  error,\n  labels,\n  title,\n  headerIcon,\n  placeholder,\n  width,\n  height,\n  zIndex,\n  showSuggestions,\n  isClosing = false,\n  resizable,\n  isMobile,\n  isResizing,\n  onResizeStart,\n  errorInfo,\n  countdown,\n  isAutoRetrying,\n  onCancelAutoRetry,\n}: ChatWindowProps) {\n  const { ref: messagesEndRef } = useScrollToBottom(messages.length, isLoading);\n\n  // Find the last assistant message index for showing suggestions\n  const lastAssistantMessageIndex = messages.reduceRight(\n    (found, msg, idx) => (found === -1 && msg.role === 'assistant' ? idx : found),\n    -1\n  );\n\n  const positionStyles: CSSProperties =\n    position === 'bottom-left'\n      ? { left: '1rem', right: 'auto' }\n      : { right: '1rem', left: 'auto' };\n\n  const mobileWidth = 'calc(100vw - 1rem)';\n  const mobileHeight = 'calc(100vh - 7rem)';\n\n  const windowStyle: CSSProperties = {\n    position: 'fixed',\n    bottom: '6rem',\n    ...positionStyles,\n    zIndex,\n    display: 'flex',\n    height: isMobile ? mobileHeight : `${height}px`,\n    width: isMobile ? mobileWidth : `${width}px`,\n    maxWidth: 'calc(100vw - 2rem)',\n    flexDirection: 'column',\n    overflow: 'hidden',\n    borderRadius: '1rem',\n    border: `1px solid ${theme.border}`,\n    backgroundColor: theme.background,\n    boxShadow: `0 8px 32px ${theme.primary}40`,\n    // Smooth transitions only when not resizing\n    transition: isResizing ? 'none' : 'width 0.1s ease-out, height 0.1s ease-out',\n  };\n\n  const headerStyle: CSSProperties = {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    borderBottom: `1px solid ${theme.border}`,\n    background: `linear-gradient(to right, ${theme.primary}, ${theme.primaryHover})`,\n    padding: '0.75rem 1rem',\n  };\n\n  // Determine animation class\n  const animationClass = isClosing\n    ? 'ai-chat-window-closing'\n    : 'ai-chat-window-opening';\n\n  return (\n    <div\n      role=\"dialog\"\n      aria-modal=\"true\"\n      aria-labelledby={title ? 'ai-chat-title' : undefined}\n      aria-label={!title ? labels.title : undefined}\n      className={animationClass}\n      style={windowStyle}\n    >\n      {/* Header */}\n      <div style={headerStyle}>\n        <div\n          style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: '0.5rem',\n            flex: 1,\n            minWidth: 0,\n          }}\n        >\n          {headerIcon && (\n            <span\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                width: '24px',\n                height: '24px',\n                flexShrink: 0,\n              }}\n            >\n              {typeof headerIcon === 'string' ? (\n                <span style={{ fontSize: '1.25rem', lineHeight: 1 }}>{headerIcon}</span>\n              ) : (\n                <span\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    width: '100%',\n                    height: '100%',\n                  }}\n                >\n                  {headerIcon}\n                </span>\n              )}\n            </span>\n          )}\n          {title && (\n            <h2\n              id=\"ai-chat-title\"\n              style={{\n                fontSize: '1.125rem',\n                fontWeight: 600,\n                color: '#ffffff',\n                margin: 0,\n                overflow: 'hidden',\n                textOverflow: 'ellipsis',\n                whiteSpace: 'nowrap',\n              }}\n            >\n              {title}\n            </h2>\n          )}\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\n          <button\n            onClick={onRestart}\n            aria-label={labels.restart}\n            style={{\n              borderRadius: '50%',\n              padding: '0.25rem',\n              color: 'rgba(255, 255, 255, 0.8)',\n              background: 'transparent',\n              border: 'none',\n              cursor: 'pointer',\n              transition: 'all 0.2s',\n              flexShrink: 0,\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.backgroundColor = 'rgba(255, 255, 255, 0.2)';\n              e.currentTarget.style.color = 'white';\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.backgroundColor = 'transparent';\n              e.currentTarget.style.color = 'rgba(255, 255, 255, 0.8)';\n            }}\n          >\n            <RestartIcon size={18} />\n          </button>\n          <button\n            onClick={onClose}\n            aria-label={labels.close}\n            style={{\n              borderRadius: '50%',\n              padding: '0.25rem',\n              color: 'rgba(255, 255, 255, 0.8)',\n              background: 'transparent',\n              border: 'none',\n              cursor: 'pointer',\n              transition: 'all 0.2s',\n              flexShrink: 0,\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.backgroundColor = 'rgba(255, 255, 255, 0.2)';\n              e.currentTarget.style.color = 'white';\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.backgroundColor = 'transparent';\n              e.currentTarget.style.color = 'rgba(255, 255, 255, 0.8)';\n            }}\n          >\n            <CloseIcon size={20} />\n          </button>\n        </div>\n      </div>\n\n      {/* Messages */}\n      <div\n        style={{\n          flex: 1,\n          overflowY: 'auto',\n          padding: '1rem',\n          backgroundColor: theme.background,\n        }}\n      >\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\n          {messages.map((message, index) => (\n            <MessageBubble\n              key={message.id}\n              message={message}\n              theme={theme}\n              showSuggestions={showSuggestions}\n              isLastAssistantMessage={index === lastAssistantMessageIndex && !isLoading}\n              suggestionsTitle={labels.suggestionsTitle}\n              onSuggestionSelect={onSuggestionSelect}\n            />\n          ))}\n\n          {isLoading && (\n            <LoadingIndicator theme={theme} text={labels.thinking} />\n          )}\n\n          {error && (\n            <ErrorMessage\n              theme={theme}\n              errorText={labels.error}\n              rateLimitErrorText={labels.rateLimitError}\n              retryText={labels.retry}\n              autoRetryingText={labels.autoRetrying}\n              cancelAutoRetryText={labels.cancelAutoRetry}\n              onRetry={onRetry}\n              errorInfo={errorInfo}\n              countdown={countdown}\n              isAutoRetrying={isAutoRetrying}\n              onCancelAutoRetry={onCancelAutoRetry}\n            />\n          )}\n\n          <div ref={messagesEndRef} />\n        </div>\n      </div>\n\n      {/* Input */}\n      <MessageInput\n        theme={theme}\n        value={input}\n        onChange={onInputChange}\n        onSubmit={onSubmit}\n        placeholder={placeholder}\n        sendLabel={labels.send}\n        isLoading={isLoading}\n        autoFocus\n      />\n\n      {/* Resize Handles (desktop only, when enabled) */}\n      {resizable && !isMobile && (\n        <ResizeHandles onResizeStart={onResizeStart} isResizing={isResizing} />\n      )}\n    </div>\n  );\n}\n","'use client';\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\n\nconst STORAGE_KEY = 'ai-chat-widget-size';\n\nexport type ResizeCorner = 'nw' | 'ne' | 'sw' | 'se';\n\ninterface StoredSize {\n  width: number;\n  height: number;\n}\n\ninterface UseResizeOptions {\n  initialWidth: number;\n  initialHeight: number;\n  minWidth: number;\n  maxWidth: number;\n  minHeight: number;\n  maxHeight: number;\n  enabled: boolean;\n}\n\ninterface UseResizeReturn {\n  width: number;\n  height: number;\n  isResizing: boolean;\n  handleResizeStart: (corner: ResizeCorner, e: React.MouseEvent) => void;\n}\n\nfunction clamp(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}\n\nfunction loadSavedSize(): StoredSize | null {\n  if (typeof window === 'undefined') return null;\n  try {\n    const stored = localStorage.getItem(STORAGE_KEY);\n    if (!stored) return null;\n    const parsed = JSON.parse(stored);\n    if (typeof parsed.width === 'number' && typeof parsed.height === 'number') {\n      return parsed;\n    }\n  } catch {\n    // Invalid stored data, ignore\n  }\n  return null;\n}\n\nfunction saveSize(size: StoredSize): void {\n  if (typeof window === 'undefined') return;\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(size));\n  } catch {\n    // Storage full or unavailable, ignore\n  }\n}\n\nexport function useResize({\n  initialWidth,\n  initialHeight,\n  minWidth,\n  maxWidth,\n  minHeight,\n  maxHeight,\n  enabled,\n}: UseResizeOptions): UseResizeReturn {\n  const [width, setWidth] = useState(() => {\n    if (!enabled) return initialWidth;\n    const saved = loadSavedSize();\n    return saved ? clamp(saved.width, minWidth, maxWidth) : initialWidth;\n  });\n\n  const [height, setHeight] = useState(() => {\n    if (!enabled) return initialHeight;\n    const saved = loadSavedSize();\n    return saved ? clamp(saved.height, minHeight, maxHeight) : initialHeight;\n  });\n\n  const [isResizing, setIsResizing] = useState(false);\n\n  const resizeState = useRef<{\n    corner: ResizeCorner;\n    startX: number;\n    startY: number;\n    startWidth: number;\n    startHeight: number;\n  } | null>(null);\n\n  const handleResizeStart = useCallback(\n    (corner: ResizeCorner, e: React.MouseEvent) => {\n      if (!enabled) return;\n      e.preventDefault();\n      e.stopPropagation();\n\n      resizeState.current = {\n        corner,\n        startX: e.clientX,\n        startY: e.clientY,\n        startWidth: width,\n        startHeight: height,\n      };\n      setIsResizing(true);\n\n      // Prevent text selection during resize\n      document.body.style.userSelect = 'none';\n      document.body.style.cursor = corner === 'nw' || corner === 'se' ? 'nwse-resize' : 'nesw-resize';\n    },\n    [enabled, width, height]\n  );\n\n  useEffect(() => {\n    if (!isResizing) return;\n\n    const handleMouseMove = (e: MouseEvent) => {\n      if (!resizeState.current) return;\n\n      const { corner, startX, startY, startWidth, startHeight } = resizeState.current;\n      const deltaX = e.clientX - startX;\n      const deltaY = e.clientY - startY;\n\n      let newWidth = startWidth;\n      let newHeight = startHeight;\n\n      // Calculate new dimensions based on corner\n      switch (corner) {\n        case 'se':\n          newWidth = startWidth + deltaX;\n          newHeight = startHeight + deltaY;\n          break;\n        case 'sw':\n          newWidth = startWidth - deltaX;\n          newHeight = startHeight + deltaY;\n          break;\n        case 'ne':\n          newWidth = startWidth + deltaX;\n          newHeight = startHeight - deltaY;\n          break;\n        case 'nw':\n          newWidth = startWidth - deltaX;\n          newHeight = startHeight - deltaY;\n          break;\n      }\n\n      // Clamp to constraints\n      newWidth = clamp(newWidth, minWidth, maxWidth);\n      newHeight = clamp(newHeight, minHeight, maxHeight);\n\n      setWidth(newWidth);\n      setHeight(newHeight);\n    };\n\n    const handleMouseUp = () => {\n      if (resizeState.current) {\n        // Save final size\n        saveSize({ width, height });\n      }\n      resizeState.current = null;\n      setIsResizing(false);\n\n      // Restore body styles\n      document.body.style.userSelect = '';\n      document.body.style.cursor = '';\n    };\n\n    document.addEventListener('mousemove', handleMouseMove);\n    document.addEventListener('mouseup', handleMouseUp);\n\n    return () => {\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [isResizing, width, height, minWidth, maxWidth, minHeight, maxHeight]);\n\n  // Save size when it changes (after resize ends)\n  useEffect(() => {\n    if (!isResizing && enabled) {\n      saveSize({ width, height });\n    }\n  }, [width, height, isResizing, enabled]);\n\n  return { width, height, isResizing, handleResizeStart };\n}\n","'use client';\n\nimport { useState, useEffect } from 'react';\n\nconst MOBILE_BREAKPOINT = 640;\n\nexport function useMobileDetect(): boolean {\n  const [isMobile, setIsMobile] = useState(() => {\n    if (typeof window === 'undefined') return false;\n    return window.innerWidth < MOBILE_BREAKPOINT;\n  });\n\n  useEffect(() => {\n    const mediaQuery = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`);\n\n    const handleChange = (e: MediaQueryListEvent) => {\n      setIsMobile(e.matches);\n    };\n\n    // Set initial value\n    setIsMobile(mediaQuery.matches);\n\n    // Listen for changes\n    mediaQuery.addEventListener('change', handleChange);\n\n    return () => {\n      mediaQuery.removeEventListener('change', handleChange);\n    };\n  }, []);\n\n  return isMobile;\n}\n","import type { ErrorInfo, ErrorType } from './errorTypes';\n\n/**\n * Patterns that indicate a rate limit error\n */\nconst RATE_LIMIT_PATTERNS = [\n  /rate.?limit/i,\n  /too.?many.?requests/i,\n  /quota.?exceeded/i,\n  /throttl/i,\n  /try.?again.?later/i,\n  /request.?limit/i,\n  /api.?limit/i,\n];\n\n/**\n * Extract HTTP status code from error\n */\nfunction extractStatusCode(error: Error): number | undefined {\n  // Check common error properties\n  const err = error as unknown as Record<string, unknown>;\n\n  if (typeof err.status === 'number') return err.status;\n  if (typeof err.statusCode === 'number') return err.statusCode;\n  if (typeof err.code === 'number') return err.code;\n\n  // Check response object\n  if (err.response && typeof err.response === 'object') {\n    const response = err.response as Record<string, unknown>;\n    if (typeof response.status === 'number') return response.status;\n    if (typeof response.statusCode === 'number') return response.statusCode;\n  }\n\n  // Try to extract from message (e.g., \"Request failed with status 429\")\n  const statusMatch = error.message.match(/status[:\\s]+(\\d{3})/i);\n  if (statusMatch) {\n    return parseInt(statusMatch[1], 10);\n  }\n\n  return undefined;\n}\n\n/**\n * Extract retry-after seconds from error\n */\nfunction extractRetryAfter(error: Error): number | undefined {\n  const err = error as unknown as Record<string, unknown>;\n\n  // Check direct property\n  if (typeof err.retryAfter === 'number') return err.retryAfter;\n  if (typeof err.retryAfterSeconds === 'number') return err.retryAfterSeconds;\n\n  // Check headers\n  if (err.headers && typeof err.headers === 'object') {\n    const headers = err.headers as Record<string, unknown>;\n    const retryAfterHeader = headers['retry-after'] || headers['Retry-After'];\n    if (typeof retryAfterHeader === 'string') {\n      const seconds = parseInt(retryAfterHeader, 10);\n      if (!isNaN(seconds)) return seconds;\n    }\n    if (typeof retryAfterHeader === 'number') return retryAfterHeader;\n  }\n\n  // Check response headers\n  if (err.response && typeof err.response === 'object') {\n    const response = err.response as Record<string, unknown>;\n    if (response.headers && typeof response.headers === 'object') {\n      const headers = response.headers as Record<string, unknown>;\n      const retryAfterHeader = headers['retry-after'] || headers['Retry-After'];\n      if (typeof retryAfterHeader === 'string') {\n        const seconds = parseInt(retryAfterHeader, 10);\n        if (!isNaN(seconds)) return seconds;\n      }\n      if (typeof retryAfterHeader === 'number') return retryAfterHeader;\n    }\n  }\n\n  // Try to extract from message (e.g., \"try again in 30 seconds\")\n  const secondsMatch = error.message.match(/(?:in|after)\\s+(\\d+)\\s*(?:second|sec|s\\b)/i);\n  if (secondsMatch) {\n    return parseInt(secondsMatch[1], 10);\n  }\n\n  return undefined;\n}\n\n/**\n * Check if error message matches rate limit patterns\n */\nfunction matchesRateLimitPattern(message: string): boolean {\n  return RATE_LIMIT_PATTERNS.some((pattern) => pattern.test(message));\n}\n\n/**\n * Determine error type from error object\n */\nfunction determineErrorType(error: Error, statusCode?: number): ErrorType {\n  const message = error.message.toLowerCase();\n\n  // Check status code first (most reliable)\n  if (statusCode === 429) return 'rate_limit';\n  if (statusCode === 401 || statusCode === 403) return 'auth';\n  if (statusCode && statusCode >= 500) return 'server';\n\n  // Check message patterns\n  if (matchesRateLimitPattern(error.message)) return 'rate_limit';\n\n  // Network errors\n  if (\n    message.includes('network') ||\n    message.includes('fetch') ||\n    message.includes('connection') ||\n    message.includes('timeout') ||\n    message.includes('offline')\n  ) {\n    return 'network';\n  }\n\n  // Auth errors\n  if (message.includes('unauthorized') || message.includes('forbidden') || message.includes('auth')) {\n    return 'auth';\n  }\n\n  // Server errors\n  if (message.includes('server') || message.includes('internal')) {\n    return 'server';\n  }\n\n  return 'generic';\n}\n\n/**\n * Determine if error type is retriable\n */\nfunction isRetriable(type: ErrorType): boolean {\n  return type === 'rate_limit' || type === 'network' || type === 'server';\n}\n\n/**\n * Classify an error and extract relevant information\n *\n * @param error - Error object from useChat or API call\n * @returns ErrorInfo object with classification, or null if error is undefined\n *\n * @example\n * ```tsx\n * const { error } = useChat({ ... });\n * const errorInfo = classifyError(error);\n *\n * if (errorInfo?.type === 'rate_limit') {\n *   console.log('Rate limited! Retry after:', errorInfo.retryAfterSeconds);\n * }\n * ```\n */\nexport function classifyError(error: Error | undefined): ErrorInfo | null {\n  if (!error) return null;\n\n  const statusCode = extractStatusCode(error);\n  const type = determineErrorType(error, statusCode);\n  const retryAfterSeconds = type === 'rate_limit' ? extractRetryAfter(error) : undefined;\n\n  return {\n    type,\n    originalError: error,\n    statusCode,\n    retryAfterSeconds,\n    isRetriable: isRetriable(type),\n  };\n}\n\n/**\n * Quick check if an error is a rate limit error\n *\n * @param error - Error object to check\n * @returns true if the error is a rate limit error\n *\n * @example\n * ```tsx\n * if (isRateLimitError(error)) {\n *   showRateLimitMessage();\n * }\n * ```\n */\nexport function isRateLimitError(error: Error | undefined): boolean {\n  if (!error) return false;\n\n  const statusCode = extractStatusCode(error);\n  if (statusCode === 429) return true;\n\n  return matchesRateLimitPattern(error.message);\n}\n","import { useState, useEffect, useCallback, useRef } from 'react';\nimport type { ErrorInfo, RateLimitOptions } from '../utils/errorTypes';\n\ninterface UseRateLimitRetryOptions extends RateLimitOptions {\n  errorInfo: ErrorInfo | null;\n  onRetry: () => void;\n}\n\ninterface UseRateLimitRetryResult {\n  /** Current countdown in seconds (0 when not counting down) */\n  countdown: number;\n  /** Whether auto-retry is currently active */\n  isAutoRetrying: boolean;\n  /** Current retry attempt number (1-based) */\n  retryAttempt: number;\n  /** Cancel the current auto-retry */\n  cancelAutoRetry: () => void;\n  /** Manually trigger retry (resets attempt counter) */\n  manualRetry: () => void;\n}\n\nconst DEFAULT_OPTIONS: Required<RateLimitOptions> = {\n  autoRetry: false,\n  maxRetries: 3,\n  baseDelayMs: 1000,\n  maxDelayMs: 30000,\n};\n\n/**\n * Calculate exponential backoff delay with jitter\n */\nfunction calculateBackoffDelay(\n  attempt: number,\n  baseDelayMs: number,\n  maxDelayMs: number,\n  serverRetryAfterSeconds?: number\n): number {\n  // If server provided a retry-after, use that (converted to ms)\n  if (serverRetryAfterSeconds && serverRetryAfterSeconds > 0) {\n    return Math.min(serverRetryAfterSeconds * 1000, maxDelayMs);\n  }\n\n  // Exponential backoff: base * 2^(attempt-1)\n  const exponentialDelay = baseDelayMs * Math.pow(2, attempt - 1);\n\n  // Add jitter (up to 25% random variation)\n  const jitter = exponentialDelay * 0.25 * Math.random();\n\n  return Math.min(exponentialDelay + jitter, maxDelayMs);\n}\n\n/**\n * Hook for handling rate limit errors with countdown and auto-retry\n *\n * @example\n * ```tsx\n * const { countdown, isAutoRetrying, cancelAutoRetry, manualRetry } = useRateLimitRetry({\n *   errorInfo,\n *   onRetry: handleRetry,\n *   autoRetry: true,\n *   maxRetries: 3,\n * });\n *\n * if (countdown > 0) {\n *   return <div>Retry in {countdown}s</div>;\n * }\n * ```\n */\nexport function useRateLimitRetry({\n  errorInfo,\n  onRetry,\n  autoRetry = DEFAULT_OPTIONS.autoRetry,\n  maxRetries = DEFAULT_OPTIONS.maxRetries,\n  baseDelayMs = DEFAULT_OPTIONS.baseDelayMs,\n  maxDelayMs = DEFAULT_OPTIONS.maxDelayMs,\n}: UseRateLimitRetryOptions): UseRateLimitRetryResult {\n  const [countdown, setCountdown] = useState(0);\n  const [isAutoRetrying, setIsAutoRetrying] = useState(false);\n  const [retryAttempt, setRetryAttempt] = useState(0);\n\n  // Track the error to detect when it changes\n  const prevErrorRef = useRef<Error | null>(null);\n  const countdownIntervalRef = useRef<ReturnType<typeof setInterval> | null>(null);\n  const retryTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  // Clean up timers\n  const clearTimers = useCallback(() => {\n    if (countdownIntervalRef.current) {\n      clearInterval(countdownIntervalRef.current);\n      countdownIntervalRef.current = null;\n    }\n    if (retryTimeoutRef.current) {\n      clearTimeout(retryTimeoutRef.current);\n      retryTimeoutRef.current = null;\n    }\n  }, []);\n\n  // Cancel auto-retry\n  const cancelAutoRetry = useCallback(() => {\n    clearTimers();\n    setIsAutoRetrying(false);\n    setCountdown(0);\n  }, [clearTimers]);\n\n  // Manual retry (resets attempt counter)\n  const manualRetry = useCallback(() => {\n    clearTimers();\n    setIsAutoRetrying(false);\n    setCountdown(0);\n    setRetryAttempt(0);\n    onRetry();\n  }, [clearTimers, onRetry]);\n\n  // Start countdown and auto-retry\n  const startCountdown = useCallback(\n    (delayMs: number, attempt: number) => {\n      clearTimers();\n\n      const seconds = Math.ceil(delayMs / 1000);\n      setCountdown(seconds);\n      setIsAutoRetrying(autoRetry && attempt <= maxRetries);\n\n      // Update countdown every second\n      countdownIntervalRef.current = setInterval(() => {\n        setCountdown((prev) => {\n          if (prev <= 1) {\n            if (countdownIntervalRef.current) {\n              clearInterval(countdownIntervalRef.current);\n              countdownIntervalRef.current = null;\n            }\n            return 0;\n          }\n          return prev - 1;\n        });\n      }, 1000);\n\n      // Schedule retry if auto-retry is enabled\n      if (autoRetry && attempt <= maxRetries) {\n        retryTimeoutRef.current = setTimeout(() => {\n          setIsAutoRetrying(false);\n          setCountdown(0);\n          onRetry();\n        }, delayMs);\n      }\n    },\n    [autoRetry, maxRetries, clearTimers, onRetry]\n  );\n\n  // Handle error changes\n  useEffect(() => {\n    const currentError = errorInfo?.originalError ?? null;\n\n    // Error cleared - reset state\n    if (!errorInfo || errorInfo.type !== 'rate_limit') {\n      if (prevErrorRef.current !== null) {\n        cancelAutoRetry();\n        setRetryAttempt(0);\n      }\n      prevErrorRef.current = currentError;\n      return;\n    }\n\n    // New rate limit error\n    if (currentError !== prevErrorRef.current) {\n      prevErrorRef.current = currentError;\n\n      const newAttempt = retryAttempt + 1;\n      setRetryAttempt(newAttempt);\n\n      const delayMs = calculateBackoffDelay(\n        newAttempt,\n        baseDelayMs,\n        maxDelayMs,\n        errorInfo.retryAfterSeconds\n      );\n\n      startCountdown(delayMs, newAttempt);\n    }\n\n    return () => {\n      // Cleanup on unmount\n    };\n  }, [errorInfo, retryAttempt, baseDelayMs, maxDelayMs, startCountdown, cancelAutoRetry]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      clearTimers();\n    };\n  }, [clearTimers]);\n\n  return {\n    countdown,\n    isAutoRetrying,\n    retryAttempt,\n    cancelAutoRetry,\n    manualRetry,\n  };\n}\n","/**\n * AI Chat Widget - A customizable chat widget for AI applications\n *\n * Features:\n * - 5 dark mode theme presets + full customization\n * - Floating button (configurable position)\n * - Expandable chat window\n * - Streaming responses with Vercel AI SDK v6\n * - Markdown rendering for responses (lazy loaded)\n * - Loading and error states\n * - Keyboard accessibility (Escape to close)\n * - i18n support (EN/ES)\n */\n\n'use client';\n\nimport { useState, useEffect, useCallback, useMemo, Component, type ReactNode } from 'react';\nimport { useChat } from '@ai-sdk/react';\nimport { DefaultChatTransport } from 'ai';\nimport type { ChatWidgetProps, Position, CustomIcons } from './types';\nimport type { Labels } from './i18n/types';\nimport type { RateLimitOptions } from './utils/errorTypes';\nimport { resolveTheme } from './themes/resolve';\nimport { mergeLabels } from './i18n';\nimport { ChatButton } from './components/ChatButton';\nimport { ChatWindow } from './components/ChatWindow';\nimport { useResize } from './hooks/useResize';\nimport { useMobileDetect } from './hooks/useMobileDetect';\nimport { classifyError } from './utils/errorClassifier';\nimport { useRateLimitRetry } from './hooks/useRateLimitRetry';\n\n// Error boundary to catch rendering failures\nclass ChatErrorBoundary extends Component<\n  { children: ReactNode; fallback?: ReactNode },\n  { hasError: boolean; error: Error | null }\n> {\n  constructor(props: { children: ReactNode; fallback?: ReactNode }) {\n    super(props);\n    this.state = { hasError: false, error: null };\n  }\n\n  static getDerivedStateFromError(error: Error) {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    console.error('[ai-chat-widget] Error caught by boundary:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n      return null;\n    }\n    return this.props.children;\n  }\n}\n\n// Default font: Inter - modern, free, open-source, optimized for screens\nconst DEFAULT_FONT_FAMILY = \"'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif\";\n\n// Google Fonts URL for Inter (weights 400, 500, 600)\nconst INTER_FONT_URL = 'https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap';\n\ninterface InternalChatWidgetProps {\n  apiUrl: string;\n  theme: ReturnType<typeof resolveTheme>;\n  position: Position;\n  labels: Labels;\n  title?: string;\n  placeholder: string;\n  greeting?: string;\n  defaultOpen: boolean;\n  width: number;\n  height: number;\n  minWidth: number;\n  maxWidth: number;\n  minHeight: number;\n  maxHeight: number;\n  resizable: boolean;\n  zIndex: number;\n  lang: string;\n  icon?: CustomIcons;\n  headerIcon?: ReactNode;\n  fontFamily: string;\n  loadDefaultFont: boolean;\n  showSuggestions: boolean;\n  rateLimitOptions: RateLimitOptions;\n}\n\n// Animation duration in ms\nconst ANIMATION_DURATION = 200;\n\nfunction ChatWidgetInternal({\n  apiUrl,\n  theme,\n  position,\n  labels,\n  title,\n  placeholder,\n  greeting,\n  defaultOpen,\n  width,\n  height,\n  minWidth,\n  maxWidth,\n  minHeight,\n  maxHeight,\n  resizable,\n  zIndex,\n  lang,\n  icon,\n  headerIcon,\n  fontFamily,\n  loadDefaultFont,\n  showSuggestions,\n  rateLimitOptions,\n}: InternalChatWidgetProps) {\n  const [isOpen, setIsOpen] = useState(defaultOpen);\n  const [isVisible, setIsVisible] = useState(defaultOpen); // Controls DOM presence\n  const [isClosing, setIsClosing] = useState(false); // Controls close animation\n  const [input, setInput] = useState('');\n  const [sessionId, setSessionId] = useState(() => crypto.randomUUID());\n  const [fontLoaded, setFontLoaded] = useState(!loadDefaultFont);\n\n  const isMobile = useMobileDetect();\n\n  const { width: currentWidth, height: currentHeight, isResizing, handleResizeStart } = useResize({\n    initialWidth: width,\n    initialHeight: height,\n    minWidth,\n    maxWidth,\n    minHeight,\n    maxHeight,\n    enabled: resizable && !isMobile,\n  });\n\n  // Handle open/close animations\n  useEffect(() => {\n    if (isOpen) {\n      // Opening: immediately show and let CSS animate\n      setIsVisible(true);\n      setIsClosing(false);\n    } else if (isVisible) {\n      // Closing: start close animation, then hide after duration\n      setIsClosing(true);\n      const timer = setTimeout(() => {\n        setIsVisible(false);\n        setIsClosing(false);\n      }, ANIMATION_DURATION);\n      return () => clearTimeout(timer);\n    }\n  }, [isOpen, isVisible]);\n\n  // Load Inter font from Google Fonts if using default font\n  useEffect(() => {\n    if (!loadDefaultFont) return;\n\n    // Check if already loaded\n    const existingLink = document.querySelector(`link[href=\"${INTER_FONT_URL}\"]`);\n    if (existingLink) {\n      setFontLoaded(true);\n      return;\n    }\n\n    // Create and append link element\n    const link = document.createElement('link');\n    link.rel = 'stylesheet';\n    link.href = INTER_FONT_URL;\n    link.onload = () => setFontLoaded(true);\n    link.onerror = () => {\n      console.warn('[ai-chat-widget] Failed to load Inter font, using system fonts');\n      setFontLoaded(true);\n    };\n    document.head.appendChild(link);\n  }, [loadDefaultFont]);\n\n  // Create transport with custom API endpoint (memoized to avoid recreating on every render)\n  const transport = useMemo(\n    () =>\n      new DefaultChatTransport({\n        api: apiUrl,\n        body: { lang, sessionId },\n      }),\n    [apiUrl, lang, sessionId]\n  );\n\n  // Initial messages - include greeting if provided\n  const initialMessages = greeting\n    ? [\n        {\n          id: 'greeting',\n          role: 'assistant' as const,\n          parts: [{ type: 'text' as const, text: greeting }],\n        },\n      ]\n    : [];\n\n  const { messages, sendMessage, regenerate, setMessages, status, error } = useChat({\n    transport,\n    messages: initialMessages,\n  });\n\n  const isLoading = status === 'streaming' || status === 'submitted';\n\n  // Classify error for rate limit detection\n  const errorInfo = useMemo(() => classifyError(error), [error]);\n\n  // Rate limit retry handling\n  const {\n    countdown,\n    isAutoRetrying,\n    cancelAutoRetry,\n    manualRetry,\n  } = useRateLimitRetry({\n    errorInfo,\n    onRetry: () => regenerate(),\n    ...rateLimitOptions,\n  });\n\n  const handleRestart = useCallback(() => {\n    setMessages(initialMessages);\n    setInput('');\n    setSessionId(crypto.randomUUID());\n  }, [setMessages, initialMessages]);\n\n  // Handle escape key to close\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === 'Escape' && isOpen) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [isOpen]);\n\n  const toggleChat = useCallback(() => setIsOpen((prev) => !prev), []);\n\n  const handleSubmit = useCallback(() => {\n    if (!input.trim() || isLoading) return;\n    sendMessage({ text: input });\n    setInput('');\n  }, [input, isLoading, sendMessage]);\n\n  const handleRetry = useCallback(() => {\n    // Use manualRetry for rate limit errors (resets attempt counter)\n    if (errorInfo?.type === 'rate_limit') {\n      manualRetry();\n    } else {\n      regenerate();\n    }\n  }, [errorInfo, manualRetry, regenerate]);\n\n  const handleSuggestionSelect = useCallback((suggestion: string) => {\n    if (isLoading) return;\n    sendMessage({ text: suggestion });\n  }, [isLoading, sendMessage]);\n\n  return (\n    <div className=\"ai-chat-widget-root\" style={{ fontFamily }}>\n      {/* Chat Window */}\n      {isVisible && fontLoaded && (\n        <ChatWindow\n          theme={theme}\n          position={position}\n          messages={messages}\n          input={input}\n          onInputChange={setInput}\n          onSubmit={handleSubmit}\n          onRetry={handleRetry}\n          onClose={toggleChat}\n          onRestart={handleRestart}\n          onSuggestionSelect={handleSuggestionSelect}\n          isLoading={isLoading}\n          error={error}\n          labels={labels}\n          title={title}\n          headerIcon={headerIcon}\n          placeholder={placeholder}\n          width={currentWidth}\n          height={currentHeight}\n          zIndex={zIndex}\n          showSuggestions={showSuggestions}\n          isClosing={isClosing}\n          resizable={resizable}\n          isMobile={isMobile}\n          isResizing={isResizing}\n          onResizeStart={handleResizeStart}\n          errorInfo={errorInfo}\n          countdown={countdown}\n          isAutoRetrying={isAutoRetrying}\n          onCancelAutoRetry={cancelAutoRetry}\n        />\n      )}\n\n      {/* Floating Toggle Button */}\n      <ChatButton\n        theme={theme}\n        position={position}\n        isOpen={isOpen}\n        onClick={toggleChat}\n        openLabel={labels.open}\n        closeLabel={labels.close}\n        zIndex={zIndex}\n        openIcon={icon?.open}\n        closeIcon={icon?.close}\n      />\n\n      {/* CSS animations and markdown styles */}\n      <style>{`\n        @keyframes ai-chat-bounce {\n          0%, 80%, 100% { transform: translateY(0); }\n          40% { transform: translateY(-6px); }\n        }\n        @keyframes ai-chat-window-open {\n          from {\n            opacity: 0;\n            transform: scale(0.95) translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: scale(1) translateY(0);\n          }\n        }\n        @keyframes ai-chat-window-close {\n          from {\n            opacity: 1;\n            transform: scale(1) translateY(0);\n          }\n          to {\n            opacity: 0;\n            transform: scale(0.95) translateY(10px);\n          }\n        }\n        .ai-chat-window-opening {\n          animation: ai-chat-window-open ${ANIMATION_DURATION}ms cubic-bezier(0.16, 1, 0.3, 1) forwards;\n          will-change: transform, opacity;\n        }\n        .ai-chat-window-closing {\n          animation: ai-chat-window-close ${ANIMATION_DURATION}ms cubic-bezier(0.16, 1, 0.3, 1) forwards;\n          will-change: transform, opacity;\n        }\n        .ai-chat-markdown p { margin: 0.25rem 0; }\n        .ai-chat-markdown ul, .ai-chat-markdown ol { margin: 0.25rem 0; padding-left: 1.25rem; }\n        .ai-chat-markdown li { margin: 0; }\n        .ai-chat-markdown strong { font-weight: 600; }\n        .ai-chat-markdown a { color: ${theme.primary}; text-decoration: underline; }\n        .ai-chat-markdown code {\n          background: ${theme.surfaceHover};\n          padding: 0.125rem 0.25rem;\n          border-radius: 0.25rem;\n          font-size: 0.875em;\n        }\n        .ai-chat-markdown pre {\n          background: ${theme.surfaceHover};\n          padding: 0.75rem;\n          border-radius: 0.5rem;\n          overflow-x: auto;\n          margin: 0.5rem 0;\n        }\n        .ai-chat-markdown pre code {\n          background: transparent;\n          padding: 0;\n        }\n      `}</style>\n    </div>\n  );\n}\n\nfunction parseCssSize(value: string, fallback: number): number {\n  if (value.endsWith('px')) {\n    return parseInt(value, 10) || fallback;\n  }\n  if (value.endsWith('vh')) {\n    return (parseInt(value, 10) / 100) * (typeof window !== 'undefined' ? window.innerHeight : 800) || fallback;\n  }\n  if (value.endsWith('vw')) {\n    return (parseInt(value, 10) / 100) * (typeof window !== 'undefined' ? window.innerWidth : 1200) || fallback;\n  }\n  return parseInt(value, 10) || fallback;\n}\n\n/**\n * AI Chat Widget\n *\n * A ready-to-use, customizable floating chat widget for AI applications.\n * Works with any backend that implements the Vercel AI SDK v6 streaming protocol.\n *\n * @example Basic usage\n * ```tsx\n * import { ChatWidget } from '@joseantonionuevo/ai-chat-widget';\n *\n * function App() {\n *   return <ChatWidget apiUrl=\"/api/chat\" />;\n * }\n * ```\n *\n * @example With theme preset\n * ```tsx\n * <ChatWidget\n *   apiUrl=\"/api/chat\"\n *   theme=\"ocean\"\n *   lang=\"es\"\n *   greeting=\"Hola! En qu puedo ayudarte?\"\n * />\n * ```\n *\n * @example With custom theme\n * ```tsx\n * <ChatWidget\n *   apiUrl=\"/api/chat\"\n *   theme={{\n *     primary: '#7bc7c1',\n *     background: '#ffffff',\n *     surface: '#f5f5f5',\n *     text: '#333333',\n *   }}\n *   title=\"Support Chat\"\n * />\n * ```\n */\nexport function ChatWidget({\n  apiUrl,\n  theme: themeProp,\n  position = 'bottom-right',\n  lang = 'en',\n  labels: customLabels,\n  greeting,\n  defaultOpen = false,\n  title: customTitle,\n  placeholder: customPlaceholder,\n  width = '420px',\n  height = '600px',\n  minWidth = '300px',\n  maxWidth = '600px',\n  minHeight = '400px',\n  maxHeight = '80vh',\n  resizable = true,\n  zIndex = 50,\n  icon,\n  headerIcon,\n  fontFamily: customFontFamily,\n  showSuggestions = true,\n  rateLimitOptions = {},\n}: ChatWidgetProps) {\n  const theme = resolveTheme(themeProp);\n  const labels = mergeLabels(lang, customLabels);\n  // Title: if explicitly set to '' or false, hide it; otherwise use custom or labels default\n  const title = customTitle === '' || customTitle === false\n    ? undefined\n    : (customTitle ?? labels.title);\n  const placeholder = customPlaceholder ?? labels.placeholder;\n\n  // Use custom font if provided, otherwise use Inter (default)\n  const fontFamily = customFontFamily ?? DEFAULT_FONT_FAMILY;\n  const loadDefaultFont = !customFontFamily; // Only load Inter if no custom font\n\n  // Parse CSS sizes to pixels\n  const widthPx = parseCssSize(width, 380);\n  const heightPx = parseCssSize(height, 500);\n  const minWidthPx = parseCssSize(minWidth, 300);\n  const maxWidthPx = parseCssSize(maxWidth, 600);\n  const minHeightPx = parseCssSize(minHeight, 400);\n  const maxHeightPx = parseCssSize(maxHeight, typeof window !== 'undefined' ? window.innerHeight * 0.8 : 600);\n\n  return (\n    <ChatErrorBoundary>\n      <ChatWidgetInternal\n        apiUrl={apiUrl}\n        theme={theme}\n        position={position}\n        labels={labels}\n        title={title}\n        placeholder={placeholder}\n        greeting={greeting}\n        defaultOpen={defaultOpen}\n        width={widthPx}\n        height={heightPx}\n        minWidth={minWidthPx}\n        maxWidth={maxWidthPx}\n        minHeight={minHeightPx}\n        maxHeight={maxHeightPx}\n        resizable={resizable}\n        zIndex={zIndex}\n        lang={lang}\n        icon={icon}\n        headerIcon={headerIcon}\n        fontFamily={fontFamily}\n        loadDefaultFont={loadDefaultFont}\n        showSuggestions={showSuggestions}\n        rateLimitOptions={rateLimitOptions}\n      />\n    </ChatErrorBoundary>\n  );\n}\n\nexport default ChatWidget;\n"]}